I"<p>工作中需要通过vpn连公司现场内网再连接数据库，可是提供的vpn客户端Mac版不好用，只有win的好用（瞧不起Mac用户嘛…），然后就想到通过win虚拟机的方式连接vpn，再把win的端口代理共享给Mac宿主机，这样就可以在Mac上直接操作现场的数据库啦（真是个天才…其实是在网上找的办法）。</p>

<p>不多say了，直接上dish～</p>

<h3 id="上菜">上菜</h3>

<p>这里我用的是VMware，没用PD，因为更新了最新PD16 BUG太多了，所以转投Vmware。首先要配置有win10的虚拟环境（过程略）。
<br />
<strong>1、</strong>设置虚拟机==网络适配器==桥接模式为WIFI，保证与Mac同网段。
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1glara7dsezj319f0u0tln.jpg" alt="" />
<br />
<strong>2、</strong>客户端把VPN连上。
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1glarvdyg6uj311q0tiwf3.jpg" alt="" />
<br />
<strong>3、</strong>以管理员身份打开cmd窗口，通过netsh命令添加端口代理。<br />
命令：<code class="highlighter-rouge">netsh interface portproxy add v4tov4 listenaddress=监听地址 listenport=监听端口 connectaddress=转发到的地址 connectport=转发到的端口</code></p>

<p>例子：<code class="highlighter-rouge">netsh interface portproxy add v4tov4 listaddress=ip listenport=22 connectaddress=ip connectport=port</code></p>

<p>查看：<code class="highlighter-rouge">netsh interface portproxy show all</code>
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1glary293tcj32ho0r0q4g.jpg" alt="" />
<br />
<strong>4、</strong>测试监听代理端口。
<code class="highlighter-rouge">netstat -ano | findstr :4000</code>
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1glasujg85oj31yc0piwpc.jpg" alt="" />
需要关闭windows的防火墙！！！
<br /><br />
<strong>5、</strong>Mac端工具链接数据库。
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1glaswnyw7cj30vz0u0jzv.jpg" alt="" />
<br />
以上，大功告成</p>

:ET